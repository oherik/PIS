QA12 - MC68HC12 Absolute crossassembler, Version 1.6.3
(c) GMV 1989-2013


File: Drilltest2.lst
                            1. ;Drilltest2.s12
---- File: "C:\Users\Erik\Documents\GitHub\PIS\Bokuppgifter\Drilltest2.s12"
                            2. 	use	Labdefs.s12
---- File: "Labdefs.s12"
                            3. ;Adresser
       0000 0600            4. DipSwitch	equ	$600
       0000 0700            5. HexDisplay	equ	$700
       0000 0400            6. DrillControl	equ	$400
       0000 0401            7. DrillStatus	equ	$401
                            8. 
000000                      9. #ifdef	SIMULATOR
                           15. #else
       0000 0004           16. DelayConst	EQU	4
                           17. #endif001000                     18. 	org	$1000
---- File: "C:\Users\Erik\Documents\GitHub\PIS\Bokuppgifter\Drilltest2.s12"
001000 86 00               19. start:	ldaa	#0
001002 7A 04 00            20. 	staa	DrillControl
001005 16 10 32            21. 	jsr	TillRefPos
001008 16 10 3F            22. 	jsr	Borra
00100B 16 10 28            23. 	jsr	Vrid1steg
00100E 16 10 3F            24. 	jsr	Borra
001011 16 10 28            25. 	jsr	Vrid1steg
001014 16 10 3F            26. 	jsr	Borra
001017 16 10 28            27. 	jsr	Vrid1steg
00101A 16 10 28            28. 	jsr	Vrid1steg
00101D 16 10 28            29. 	jsr	Vrid1steg
001020 16 10 3F            30. 	jsr	Borra
001023 16 10 58            31. 	jsr	GeLarm
001026 20 FE               32. stopp:	bra	stopp
                           33. 
001028                     34. Vrid1steg:	
001028 86 02               35. 	ldaa	#2		;Medurs (ettställ bit 1, nollställ övriga)
00102A 7A 04 00            36. 	staa	DrillControl	
00102D 42                  37. 	inca
00102E 7A 04 00            38. 	staa	DrillControl	;Stega (addera 1 till 2 = 3 => bit 1 och 0 ettställda)
001031 3D                  39. 	rts
001032                     40. 	
001032                     41. TillRefPos:	
001032 B6 04 01            42. 	ldaa	DrillStatus
001035 84 01               43. 	anda	#1		;Maska bort bit 1-7
001037 27 01               44. 	beq	TillRefPos_turn	
001039 3D                  45. 	rts	
00103A                     46. TillRefPos_turn
00103A 16 10 28            47. 	jsr	Vrid1steg
00103D 20 F3               48. 	bra	TillRefPos
00103F                     49. 	
                           50. 
00103F                     51. Borra:	
00103F 86 04               52. 	ldaa	#4	;Starta motor
001041 7A 04 00            53. 	staa	DrillControl
001044 8B 08               54. 	adda	#8	;Sänk borr
001046 7A 04 00            55. 	staa	DrillControl
001049                     56. Borra_read_status:
001049 F6 04 01            57. 	ldab	DrillStatus
00104C C4 04               58. 	andb	#4
00104E 27 F9               59. 	beq	Borra_read_status
001050 80 08               60. 	suba	#8	;Höj borr
001052 7A 04 00            61. 	staa	DrillControl	;Höj borren
001055 79 04 00            62. 	clr	DrillControl
001058                     63. 	
001058                     64. GeLarm:	
001058 86 10               65. 	ldaa	#$10
00105A 7A 04 00            66. 	staa	DrillControl
00105D 3D                  67. 	rts
