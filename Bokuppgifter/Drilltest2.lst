QA12 - MC68HC12 Absolute crossassembler, Version 1.6.3
(c) GMV 1989-2013


File: Drilltest2.lst
                            1. ;Drilltest2.s12
---- File: "C:\Users\Erik\Documents\GitHub\PIS\Bokuppgifter\Drilltest2.s12"
                            2. 	use	Labdefs.s12
---- File: "Labdefs.s12"
                            3. ;Adresser
       0000 0600            4. DipSwitch	equ	$600
       0000 0700            5. HexDisplay	equ	$700
       0000 0400            6. DrillControl	equ	$400
       0000 0401            7. DrillStatus	equ	$401001000                      8. 	org	$1000
---- File: "C:\Users\Erik\Documents\GitHub\PIS\Bokuppgifter\Drilltest2.s12"
001000 86 00                9. start:	ldaa	#0
001002 7A 04 00            10. 	staa	DrillControl
001005 16 10 32            11. 	jsr	TillRefPos
001008 16 10 3F            12. 	jsr	Borra
00100B 16 10 28            13. 	jsr	Vrid1steg
00100E 16 10 3F            14. 	jsr	Borra
001011 16 10 28            15. 	jsr	Vrid1steg
001014 16 10 3F            16. 	jsr	Borra
001017 16 10 28            17. 	jsr	Vrid1steg
00101A 16 10 28            18. 	jsr	Vrid1steg
00101D 16 10 28            19. 	jsr	Vrid1steg
001020 16 10 3F            20. 	jsr	Borra
001023 16 10 58            21. 	jsr	GeLarm
001026 20 FE               22. stopp:	bra	stopp
                           23. 
001028                     24. Vrid1steg:	
001028 86 02               25. 	ldaa	#2		;Medurs (ettställ bit 1, nollställ övriga)
00102A 7A 04 00            26. 	staa	DrillControl	
00102D 42                  27. 	inca
00102E 7A 04 00            28. 	staa	DrillControl	;Stega (addera 1 till 2 = 3 => bit 1 och 0 ettställda)
001031 3D                  29. 	rts
001032                     30. 	
001032                     31. TillRefPos:	
001032 B6 04 01            32. 	ldaa	DrillStatus
001035 84 01               33. 	anda	#1		;Maska bort bit 1-7
001037 27 01               34. 	beq	TillRefPos_turn	
001039 3D                  35. 	rts	
00103A                     36. TillRefPos_turn
00103A 16 10 28            37. 	jsr	Vrid1steg
00103D 20 F3               38. 	bra	TillRefPos
00103F                     39. 	
                           40. 
00103F                     41. Borra:	
00103F 86 04               42. 	ldaa	#4	;Starta motor
001041 7A 04 00            43. 	staa	DrillControl
001044 8B 08               44. 	adda	#8	;Sänk borr
001046 7A 04 00            45. 	staa	DrillControl
001049                     46. Borra_read_status:
001049 F6 04 01            47. 	ldab	DrillStatus
00104C C4 04               48. 	andb	#4
00104E 27 F9               49. 	beq	Borra_read_status
001050 80 08               50. 	suba	#8	;Höj borr
001052 7A 04 00            51. 	staa	DrillControl	;Höj borren
001055 79 04 00            52. 	clr	DrillControl
001058                     53. 	
001058 3D                  54. GeLarm:		rts
